## 限制批量请求失败时只弹出一个 toast
为了确保在批量请求失败时只弹出一个 Toast 提示，可以通过以下步骤实现：

1. 维护一个全局的标志位：用于控制 Toast 是否显示。
2. 在批量请求开始之前设置标志位：确保批量请求开始时标志位被正确设置。
3. 在批量请求结束之后重置标志位：无论批量请求成功还是失败，都需要重置标志位。
4. 在请求失败时检查标志位：如果标志位允许，则显示 Toast。

```js
// 引入 Toast 组件
import { Toast } from 'vant';

let isToastShown = false;

// 创建 Axios 实例
const axiosInstance = axios.create({
  baseURL: 'https://api.example.com',
});

// 添加响应拦截器
axiosInstance.interceptors.response.use(
  response => {
    // 成功逻辑
    return response;
  },
  error => {
    if (!isToastShown) {
      Toast('请求失败，请稍后重试');
      isToastShown = true;
    }
    return Promise.reject(error);
  }
);

// 发送请求
function sendRequest(url, data) {
  return axiosInstance.post(url, data)
    .then(response => {
      // 处理成功情况
      return response.data;
    })
    .catch(error => {
      // 处理错误情况
      return Promise.reject(error);
    });
}

// 批量请求示例
async function batchRequests(urls, data) {
  try {
    isToastShown = false; // 开始批量请求前重置标志位
    await Promise.all(urls.map(url => sendRequest(url, data)));
  } catch (error) {
    isToastShown = true; // 设置标志位，确保只显示一次 Toast
    console.error('Batch request failed:', error);
  } finally {
    isToastShown = false; // 无论成功还是失败，批量请求结束后重置标志位
  }
}
```
## 如何减少项目里的 if-else
1. 提前return，让正常流程走主干
2. 使用短路运算，如 &&、||
3. 使用排非策略：!、!!
4. 使用三元运算符
5. 使用 switch-case
6. 定义相关函数拆分逻辑，简化代码

## 如何做好前端监控方案？
### 意义
前端监控的意义在于实时监控前端应用的状态，及时发现并解决问题，提高用户体验。通过前端监控，可以及时发现页面加载缓慢、接口请求失败、用户行为异常等问题，从而及时修复这些问题，提高应用的稳定性和用户体验。

### 监控内容
前端监控主要包括 用户行为、程序异常、运行性能这三方面的内容。
1. 用户行为 - 用户在网站或App上浏览了哪些模块，热点区域有哪些，用户画像等数据
2. 程序异常 - 系统运行过程中JS脚本报错、资源（图片、CSS等）加载异常信息
3. 运行性能 - 侧重系统的性能指标，比如页面的白屏时间、秒开率，载入时长等

### 监控的形式
主要分为两类：主动监控 和 被动监控。
1. 被动监控 - 基于真实用户场景，通常经过页面埋点、数据上报、统计分析和生成报警等环节。
2. 主动监控 - 基于仿真模拟环境，通过主动嗅探页面的运行状态达到实时监测的目的。

### 总体方案设计
一般监控系统，都是经过页面埋点，数据上报，后台存储，汇总统计，报警展示，优化整改等几个环节，每个环节都可以采用不同的方案来迎合业务的需求。
- 页面埋点 - 设定好在哪些地方上报统计的数据，比如用户点击某个按钮时，上报相应的数据标识，又或者在页面初始化的过程中
- 数据上报 - 将前端采集的到数据信息，发送给监控统计的后台接口
- 数据存储 - 监控数据存储的地方，根据数据量的大小选择不同的方案，如关系型数据库MySQL、Hadoop等
- 汇总统计 - 上报的监控数据，有很多无效的，需要清洗加工，按需统计汇总，方便展示
- 报警展示 - 一般需要搭建一个管理平台，设置监控指标的阈值参数，当触发时，通知给开发
- 优化整改 - 监控的最终目的让系统运行更优，根据监控结果制定系统的下一步优化方案

## 如何标准化处理线上用户反馈的问题？
1. 确定问题范围：首先需要确定用户反馈的问题是否是普遍存在的，还是个例问题。如果是普遍存在的，那么需要进一步确定问题的范围，比如是哪个页面、哪个功能模块的问题。
2. 收集问题信息：收集用户反馈的问题信息，包括问题描述、用户操作步骤、截图等。这些信息将有助于问题的定位和解决。
3. 问题分类：根据问题的性质和影响范围，将问题分类。比如是前端问题、后端问题、网络问题等。
4. 优先级评估：根据问题的严重程度和影响范围，评估问题的优先级。优先处理严重程度高、影响范围广的问题。
5. 建立问题跟踪：为每个问题建立跟踪记录，记录问题的状态、处理进度等。这样可以确保问题的处理过程透明，便于跟踪和沟通。
6. 分配责任人：根据问题的性质和影响范围，分配责任人。责任人需要负责问题的解决，并确保问题的及时处理。
7. 问题修复与验证：开发团队内各责任人均修复并自行验证完成后，QA 团队验证修复后的功能是否正常工作。
8. 线上部署及反馈：修复完成后，进行线上部署，并收集用户反馈，验证问题是否得到解决。
9. 问题总结：问题解决后，需要对问题的原因进行分析，总结经验教训，避免类似问题再次发生。

## 怎么做代码重构？
代码重构是在不改变软件外部行为的前提下，改善其内部结构的过程。这通常是为了提高代码质量、可读性和可维护性。下面是一些常用的代码重构技巧和步骤：
1. 提取方法：将重复的代码提取到一个单独的方法中，以提高代码的复用性和可读性。
2. 简化条件表达式：将复杂的条件表达式简化，以提高代码的可读性。
3. 提取变量：将复杂的表达式提取到一个变量中，以提高代码的可读性。
4. 修改变量名：修改变量名，以更好地反映变量的用途和含义。
5. 重构文档和注释：更新文档和注释，以反映代码的当前状态和用途。
6. 优化代码结构：优化代码结构，以提高代码的可读性和可维护性。
7. 代码审查：进行代码审查，以发现潜在的问题和改进机会。
8. 测试：在重构过程中，确保对代码进行充分的测试，以确保重构不会引入新的问题。

## 清理项目源码中没有被应用的代码
清理项目源码中未使用的代码可以提高代码质量，减少构建时间，并且有助于维护。以下是针对 JavaScript、TypeScript 和 CSS 的具体步骤：
### 准备阶段
1. 备份代码库
2. 创建分支
3. 设置测试环境
### 清理方法
1. 安装 ESLint 和相关插件
- ESLint 是一个流行的 JavaScript 代码检查工具，可以帮助我们找出代码中的潜在问题，并按照一定的规则进行代码格式化。
- 安装 ESLint：`npm install eslint --save-dev`
- 安装 ESLint 插件：`npm install eslint-plugin-unused-imports --save-dev`
2. 配置 ESLint
- 在项目根目录下创建一个 `.eslintrc.js` 文件，并添加以下配置：
```javascript
module.exports = {
  plugins: ["unused-imports"],
  rules: {
    "unused-imports/no-unused-imports": "error",
    "unused-imports/no-unused-vars": "warn",
  },
  settings: {
    'import/resolver': {
      node: {
        extensions: ['.js', '.jsx', '.ts', '.tsx']
      }
    }
  }
};
```
3. 删除未使用的导入和变量
- 根据 ESLint 的报告，手动删除未使用的导入和变量，或者使用 ESLint 插件自动修复。
4. 运行测试
- 运行测试用例，以确保代码重构没有引入新的问题。
5. Tree shaking
- 如果使用 Webpack 或 Rollup 等打包工具，可以使用 Tree shaking 功能来删除未使用的代码。

### 验证和合并
1. 验证代码
- 确保代码重构没有引入新的问题，并且功能正常工作。
2. 合并分支
- 将代码重构分支合并到主分支，并提交代码。

// TODO:
## 如何实现前端埋点

## 微前端架构是什么？

## Qiankun 是怎么做代码隔离的？

## 实现网页进度条
使用 nprogress  + Vue-Router 实现全局进度条
```javascript
// main.js
import Vue from 'vue'
import App from './App.vue'
import router from './router'
import store from './store'
import NProgress from 'nprogress'
import 'nprogress/nprogress.css'

Vue.config.productionTip = false

router.beforeEach((to, from, next) => {
  NProgress.start()
  next()
})

router.afterEach(() => {
  NProgress.done()
})

new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')
```

## Cookie 构成部分
主要包括以下几个部分：
1. 名称（Name）：Cookie的名称是用于标识Cookie的唯一字符串。这个名称在创建Cookie时指定，并在后续的请求中用于识别特定的Cookie。

2. 值（Value）：Cookie的值是与其名称相关联的数据。它可以是任何类型的数据，例如字符串、数字或布尔值。值可以在创建Cookie时设置，并在后续的请求中使用。

3. 域（Domain）：Cookie的域是指可以访问该Cookie的域名。它可以是完整的域名（例如example.com）或子域名（例如subdomain.example.com）。只有与Cookie的域匹配的网站才能访问该Cookie。

4. 路径（Path）：Cookie的路径是指可以访问该Cookie的URL路径。它可以是完整的路径（例如/example）或目录路径（例如/）。只有与Cookie的路径匹配的URL才能访问该Cookie。

5. 过期时间（Expires/Max-Age）：Cookie的过期时间是指Cookie的有效期。它可以是一个具体的日期和时间（Expires），也可以是一个相对的时间间隔（Max-Age）。一旦Cookie过期，浏览器将不再发送该Cookie。如果不设置过期时间，则Cookie可能仅存储在内存中，并在浏览器关闭时失效。

6. 安全标志（Secure）：安全标志是一个布尔值，用于指示浏览器只在通过加密协议（如HTTPS）发送请求时才发送该Cookie。这可以确保Cookie的安全性。

7. HttpOnly标志（HttpOnly）：HttpOnly标志也是一个布尔值，用于指示浏览器只在通过HTTP请求时发送该Cookie。这可以防止恶意脚本通过JavaScript访问Cookie，提高Cookie的安全性。

## 设计大型前端应用的过程
1. 需求分析：首先，需要明确前端应用的需求，包括功能、性能、用户体验等方面。这一阶段需要与产品经理、设计师和后端开发人员进行沟通，确保对需求的理解一致。

2. 技术选型：根据需求分析的结果，选择合适的前端技术栈。这包括选择合适的框架、库、工具等。需要考虑技术成熟度、社区支持、团队熟悉程度等因素。

3. 架构设计：根据需求和技术选型，设计前端应用的架构。这包括模块化、组件化、状态管理等。需要考虑代码的可维护性、可扩展性、可测试性等方面。

4. 开发与测试：根据架构设计，进行前端应用的开发。在开发过程中，需要编写单元测试、集成测试和端到端测试，以确保代码的质量和功能的正确性。

5. 部署与监控：将前端应用部署到生产环境，并进行监控和优化。需要关注应用的性能、稳定性、安全性等方面，及时解决可能出现的问题。


## 好的协作工具和团队协作流程
### 协作工具
1. 代码管理工具：Git
2. 项目管理工具：Xmind 
3. 设计协作工具：Figma
4. 在线绘图工具：ProcessOn
### 团队协作流程
1. 明确项目目标和需求
* 在项目开始前，与团队成员共同明确项目目标和需求，确保大家对项目有统一的认识。

2. 制定项目计划和时间表
* 使用项目管理工具制定详细的项目计划和时间表，明确每个阶段的任务和负责人。

3. 分配任务和跟踪进度
* 根据项目计划分配任务给团队成员，并使用项目管理工具跟踪任务进度和完成情况。

4. 定期召开团队会议
* 定期召开团队会议，分享项目进展、解决问题、讨论需求和进行知识分享。

5. 进行代码审查和测试
* 在代码提交前进行代码审查，确保代码质量；在开发过程中进行单元测试、集成测试等，确保软件质量。

6. 持续集成和部署
* 使用持续集成和部署工具自动化构建、测试和部署流程，提高开发效率和质量。

7. 收集反馈并迭代优化
* 在项目过程中收集用户反馈和团队成员的建议，不断迭代优化产品功能和用户体验。


## 修改第三方 npm 包
使用 patch-package 补丁包
### 1. 安装 patch-package

首先，需要在项目中安装 patch-package 和 postinstall 脚本。
```bash
npm install -D patch-package postinstall-postinstall
```
> postinstall-postinstall 是一个 npm 钩子，它会在每次 npm install 或 yarn install 后自动运行 patch-package。这不是必需的，但它可以使补丁的应用自动化。

### 2. 修改第三方包并生成补丁文件
在项目中修改第三方包的代码后，需要运行 patch-package 命令来生成补丁文件。你需要指定要为其创建补丁的包名（你可以从 package.json 中的 dependencies 或 devDependencies 部分找到它）。可以使用以下命令生成补丁文件：
```bash
npx patch-package 包名
```
**这条命令会在你的项目根目录下创建一个名为 patches/<包名>+<版本号>.patch 的文件，其中包含了你的修改。**

### 3. 提交补丁文件
将生成的补丁文件提交到 git 中，以便其他人可以应用它。

### 4. 自动化补丁应用
如果你安装了 postinstall-postinstall，那么每次运行 npm install 或 yarn install 时，patch-package 都会自动应用这些补丁。如果没有安装，你可以在 package.json 的 scripts 部分添加一个脚本来手动应用补丁：
```json
"scripts": {
  "postinstall": "patch-package"
}
```
然后，你可以通过运行 npm run postinstall 或简单地 npm install（如果安装了 postinstall-postinstall）来应用补丁。

## 限制用户单设备登录
是指同一个用户账号在同一时间只能在一个设备上登录，从而防止账号被滥用或未经授权的访问。
实现方式：
### 服务端
1. Token 管理
* 分配唯一Token：每次用户在应用上登录时，服务端应为该用户分配一个新的、唯一的Token。这个Token可以作为用户会话的唯一标识符。
* Token存储：服务端需要将这个Token与用户的账号信息关联起来并存储，以便在后续的请求中进行验证。
* Token有效性检查：在每次接收到用户的请求时，服务端都应检查该请求中携带的Token是否有效，包括是否过期、是否被撤销以及是否与当前登录的用户账号匹配。
  
2. 设备管理
* 收集设备信息：在登录时，服务端可以收集一些设备信息（如设备的IP地址、设备ID、操作系统等），作为用户设备的唯一标识，并将其存储在数据库中。
* 设备标识管理：将设备标识与用户的Token或账号信息关联起来，以便追踪用户登录的设备。

3. 登录状态管理
* 记录登录状态：当用户在一个设备上登录时，服务端应记录该设备的登录状态，并标记为“活跃”。
* 检测重复登录：当用户尝试在另一个设备上登录时，服务端应检查该用户是否已经在其他设备上处于活跃状态。如果是，则执行相应的下线操作（如强制前一个设备下线）。

### 客户端
1. Token管理
* 存储Token：客户端在接收到服务端分配的Token后，应将其安全地存储在本地（如使用SharedPreferences、Keychain等）。
* 携带Token：在后续的请求中，客户端应将Token作为请求的一部分发送给服务端，以便进行身份验证和会话管理。

2. 监听登录状态变化
* API请求响应：客户端应监听API请求的响应，特别是与登录状态相关的响应。如果响应中包含特定的错误码（如“账号已在其他设备登录”），则执行相应的下线操作。
* 推送通知：服务端可以使用推送服务（如FCM、APNs等）向客户端发送通知，告知用户账号已在其他设备登录。客户端在接收到这类通知后，应执行下线操作。

3. 用户反馈
* 提示信息：在检测到账号已在其他设备登录时，客户端应向用户显示友好的提示信息，说明情况并引导用户重新登录。
* 跳转登录页面：在提示用户后，客户端应自动跳转到登录页面，以便用户重新输入账号和密码进行登录。

### 安全性考虑
1. Token安全性
* HTTPS：确保所有与Token相关的请求都通过HTTPS进行，以防止Token在传输过程中被截获。
* Token有效期：设置合理的Token有效期，并在过期后要求用户重新登录。这有助于减少Token泄露的风险。

2. 设备信息保护
* 最小化收集：仅收集必要的设备信息以进行登录状态管理，避免收集过多的敏感信息。
* 加密存储：如果需要将设备信息存储在服务端，应使用加密技术来保护这些信息的安全。

3. 异常处理
* 错误码定义：定义清晰的错误码来标识各种登录状态异常，以便客户端能够准确地识别和处理这些情况。
* 日志记录：在服务端记录登录相关的日志信息，以便在出现问题时进行故障排查和追踪。


