## 为什么 Vite 比 Webpack 更快？
主要是因为 Vite 采用了 不同的开发模式、充分利用了 浏览器对 ES Modules 的支持、使用了更高效的底层语言 并 优化了热更新机制。

### 开发模式的差异
- 在开发环境中，Webpack 是基于打包器（bundler）的，需要先打包再启动开发服务器，而 Vite 是基于原生 ES 模块的，直接启动服务器，在打包时只打包当前文件，在请求模块时再进行实时编译。 
  
使用 Webpack 时，所有的模块都需要在开发前打包，会增加启动时间和构建时间，而 Vite 会在请求模块时再进行实时编译，这种按需动态编译的模式可以大大减少编译时间。

### Vite 的依赖预构建
- Vite 在启动时会预构建依赖，将依赖转换为 ESM 格式，从而加快模块的加载速度。而 Webpack 则是在打包时处理依赖，会增加打包时间。

### Vite 对原生 ES Modules 的支持
- Vite 利用浏览器的原生 ES 模块支持，无需打包，将开发环境下的模块文件直接作为浏览器要执行的文件。而 Webpack 则需要将模块打包成 CommonJS 或 AMD 格式，增加了打包时间。

### ES Modules
通过使用 export 和 import 语句，ES Modules 允许在浏览器端导入和导出模块。

当使用 ES Modules 进行开发时，实际上是在构建一个 依赖关系图，不同的依赖项之间通过 导入语句 进行关联。

- ES Modules 是 JavaScript 模块的标准，目前主流浏览器（除IE外）均支持 ES Modules，并且可以通过在 script 标签中设置 type="module" 来加载模块。而 Webpack 则需要使用 Babel 或 TypeScript 进行编译。

### Vite 与 Webpack 底层语言的差异
- Webpack 是基于 Node.js 构建的，而 Vite 是基于 esbuild 进行预构建依赖。esbuild 是一个 Go 语言编写的。Go 语言在编译速度和执行效率上，远超 Node.js。

### 预构建依赖
指的是在项目 启动或构建 之前，对项目中所需的依赖项进行预先的 处理或构建。当项目实际运行时，可以直接使用这些已经构建好的依赖，而无需再进行实时的编译或构建，从而提高了项目的启动速度。
预构建依赖 的过程包括以下几个步骤：
1. 扫描项目中的依赖项，并将这些依赖项添加到预构建依赖列表中。
2. 对预构建依赖列表中的依赖项进行预处理，将其转换为 ESM 格式。
3. 将预处理后的依赖项保存到缓存中，以便在后续的构建或启动过程中使用。

## 热更新的处理
- Vite 启动时，会扫描项目中的文件，创建有一个模块依赖图实例，记录项目中各个模块之间的依赖关系，使用文件系统来监控项目文件的变化，当检测到文件修改时，Vite 会计算出来哪些模块受到了有影响，并标记为需要更新的。并通过 WebSocket 协议将模块的更新信息发送给浏览器，浏览器接收到更新信息后，执行相应的更新操作，如替换旧模块、执行新的模块代码等 并更新到页面。
- Webapck 中，当一个模块或其依赖的模块内容改变时，Webpack 会重新编译整个模块，并将新的模块内容发送给浏览器。

## vite 涉及到了哪些底层原理？

### ES 模块
Vite 使用了 ES 模块来管理和加载模块。ES 模块是 JavaScript 的标准模块系统，相比于传统的 CommonJS 或 AMD，ES 模块具有更好的静态分析能力和更高的性能。Vite 通过使用浏览器原生的 ES 模块加载器，可以实现按需加载和快速构建。

### HTTP/2
Vite 借助于现代浏览器的 HTTP/2 支持来实现更高效的资源加载。HTTP/2 支持多路复用，可以同时请求多个资源，避免了传统的 HTTP/1 中的队头阻塞问题，加快了资源加载速度。

### 编译器
Vite 使用了自定义的编译器来处理开发时的模块解析和转换。它能够识别模块的依赖关系，并将模块转换为浏览器可直接执行的代码。Vite 的编译器支持热模块替换（HMR），可以在代码修改时自动更新浏览器中的页面，提高开发效率。

### 中间件
Vite 使用了基于 Koa 框架的中间件来处理开发服务器。通过中间件，Vite 可以拦截和处理开发时的 HTTP 请求，并根据请求的路径返回相应的模块文件。中间件还可以处理各种开发时的特殊需求，如代理 API 请求、路由转发等。

Vite 基于 ES 模块、HTTP/2、自定义编译器和中间件等底层原理，实现了快速的模块加载和开发体验。 这些原理的运用使得 Vite 在开发环境下能够提供更快的构建速度和更好的开发体验。

## vite 编译器的组成部分=
### esbuild
一个快速的 JavaScript 打包器，用于在开发阶段进行实时编译。esbuild 提供了快速的冷启动和热模块替换功能，能够极大地加快开发环境的构建速度。

### Rollup
一个强大的 JavaScript 模块打包器，在生产构建阶段使用。Rollup 能够将源代码打包为最终可发布的文件，支持代码分割、Tree Shaking 等优化技术，生成更小、更高效的代码包。

### 前端开发服务器
Vite 还提供了一个内置的开发服务器，用于提供开发环境下的静态文件服务和构建工具集成。这个服务器能够利用 esbuild 实现快速的编译和热模块替换，使开发者在开发过程中可以快速地预览和调试代码。

### 插件系统
Vite 通过插件系统来扩展其功能。开发者可以编写自定义的插件，用于处理特定的文件类型、引入额外的功能或者定制构建过程。插件系统使得 Vite 能够与各种前端框架和工具集成，并提供更灵活的开发体验。

## vite 编译器有啥特点？
### 快速冷启动
Vite 采用了一种新的开发服务器，利用浏览器原生的 ES 模块导入功能，无需提前构建和打包，可以实现快速的冷启动，并在浏览器中按需编译和加载代码。这种特性使得开发时的重新加载速度非常快，提高了开发效率。

### 按需编译
Vite 通过解析导入的模块路径，只编译当前需要的模块，而不是像传统的打包工具一样对整个项目进行全量编译。这种按需编译的方式减少了不必要的重复编译和构建时间，提高了构建速度。

### 零配置
Vite 提供了一种零配置的开发体验，无需繁琐的配置文件，可以快速开始项目的开发。Vite 默认支持常见的前端开发场景，如 Vue、React、TypeScript 等，开发者可以通过简单的配置进行个性化定制。

### 原生 ES 模块支持
Vite 利用浏览器原生的 ES 模块导入功能，可以直接在浏览器中引入 ES 模块，无需经过任何编译和转换，提供了更好的开发体验和更高的性能。

### 插件化
Vite 的构建系统采用了插件化的架构，开发者可以根据需求选择和配置不同的插件来扩展 Vite 的功能。Vite 提供了丰富的插件生态系统，使得开发者可以定制化地满足项目需求。

